{"version":3,"sources":["file:///F:/bigsinger/Farm/FarmCreator372/assets/ts/fireworks.ts"],"names":["_decorator","Component","Animation","UIOpacity","AnimationClip","ccclass","property","Fireworks","loopCount","maxLoopCount","start","uiOpacity","node","getComponent","addComponent","opacity","anim","fireworksClip","wrapMode","WrapMode","Loop","on","EventType","FINISHED","console","log","stop","play"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,a,OAAAA,a;;;;;;;;;OACtD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;yBAGTO,S,WADpBF,OAAO,CAAC,WAAD,C,UAEHC,QAAQ,CAACF,aAAD,C,2BAFb,MACqBG,SADrB,SACuCN,SADvC,CACiD;AAAA;AAAA;;AAAA;;AAAA,eAIrCO,SAJqC,GAIjB,CAJiB;AAAA,eAKrCC,YALqC,GAKd,CALc;AAAA;;AAOtCC,QAAAA,KAAK,GAAG;AACX,cAAMC,SAAS,GAAG,KAAKC,IAAL,CAAUC,YAAV,CAAuBV,SAAvB,KAAqC,KAAKS,IAAL,CAAUE,YAAV,CAAuBX,SAAvB,CAAvD;AACAQ,UAAAA,SAAS,CAACI,OAAV,GAAoB,GAApB;AACA,cAAMC,IAAe,GAAG,KAAKH,YAAL,CAAkBX,SAAlB,CAAxB;;AAEA,cAAI,KAAKe,aAAT,EAAwB;AACpB,iBAAKA,aAAL,CAAmBC,QAAnB,GAA8Bd,aAAa,CAACe,QAAd,CAAuBC,IAArD;AACH;;AAEDJ,UAAAA,IAAI,CAACK,EAAL,CAAQnB,SAAS,CAACoB,SAAV,CAAoBC,QAA5B,EAAsC,MAAM;AACxC,iBAAKf,SAAL;AACAgB,YAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB,KAAKjB,SAA1B,EAAqC,IAArC;;AACA,gBAAI,KAAKA,SAAL,IAAkB,KAAKC,YAA3B,EAAyC;AACrCE,cAAAA,SAAS,CAACI,OAAV,GAAoB,CAApB;AACA,mBAAKP,SAAL,GAAiB,CAAjB;AACAQ,cAAAA,IAAI,CAACU,IAAL;AACAF,cAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACH,aALD,MAKK;AACDT,cAAAA,IAAI,CAACW,IAAL,CAAU,WAAV,EADC,CACuB;AAC3B;AACJ,WAXD,EAWG,IAXH;AAaAX,UAAAA,IAAI,CAACW,IAAL,CAAU,WAAV,EAtBW,CAsBa;AAC3B;;AA9B4C,O;;;;;iBAEP,I","sourcesContent":["import { _decorator, Component, Node, Animation, UIOpacity, AnimationClip, AnimationState } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Fireworks')\r\nexport default class Fireworks extends Component {\r\n    @property(AnimationClip)\r\n    public fireworksClip: AnimationClip = null;\r\n\r\n    private loopCount: number = 0;\r\n    private maxLoopCount: number = 3;\r\n\r\n    public start() {\r\n        const uiOpacity = this.node.getComponent(UIOpacity) || this.node.addComponent(UIOpacity);\r\n        uiOpacity.opacity = 255;\r\n        const anim: Animation = this.getComponent(Animation);\r\n\r\n        if (this.fireworksClip) {\r\n            this.fireworksClip.wrapMode = AnimationClip.WrapMode.Loop;\r\n        }\r\n\r\n        anim.on(Animation.EventType.FINISHED, () => {\r\n            this.loopCount++;\r\n            console.log(\"烟花播放 \", this.loopCount, \" 次\");\r\n            if (this.loopCount >= this.maxLoopCount) {\r\n                uiOpacity.opacity = 0;\r\n                this.loopCount = 0;\r\n                anim.stop();\r\n                console.log(\"烟花播放次数达到，停止播放\");\r\n            }else{\r\n                anim.play(\"fireworks\"); // 播放动画\r\n            }\r\n        }, this);\r\n\r\n        anim.play(\"fireworks\"); // 播放动画\r\n    }\r\n}\r\n"]}